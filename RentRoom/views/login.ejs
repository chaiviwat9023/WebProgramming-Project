<%- include("partials/head") %>

<body>

    <!-- เรียกใช้ Navbar -->
    <%- include("partials/nav") %>

    <!-- เนื้อหาแต่ละหน้า -->
    <div class="container d-flex justify-content-center align-items-center vh-100">
        <div class="card p-4 shadow-lg" style="width: 400px;">
            <h3 class="text-center" id="formTitle">เข้าสู่ระบบ</h3>

            <!-- ฟอร์ม Login -->
            <form id="loginForm">
                <div class="mb-3">
                    <label for="email" class="form-label">ชื่อผู้ใช้</label>
                    <input type="email" class="form-control" id="username" placeholder="" required>
                </div>
                <div class="mb-3">
                    <label for="password" class="form-label">รหัสผ่าน</label>
                    <input type="password" class="form-control" id="password" placeholder="" required>
                </div>
                <button type="submit" class="btn btn-primary w-100">ยืนยัน</button>
            </form>

            <!-- ฟอร์ม Register (ซ่อนตอนแรก) -->
            <form id="registerForm" style="display: none;">
                <div class="mb-3">
                    <label for="firstName" class="form-label">ชื่อผู้ใช้</label>
                    <input type="text" class="form-control" id="registerusername" placeholder="" required>
                </div>
                <div class="mb-3">
                    <label for="lastName" class="form-label">อีเมล</label>
                    <input type="email" class="form-control" id="registerEmail" placeholder="" required>
                </div>
                <div class="mb-3">
                    <label for="registerEmail" class="form-label">รหัสผ่าน</label>
                    <input type="password" class="form-control" id="registerPassword" placeholder=""required>
                </div>
                <div class="mb-3">
                    <label for="registerPassword" class="form-label">ยืนยันรหัสผ่าน</label required> 
                    <input type="password" class="form-control" id="confirmPassword"
                        placeholder="">
                </div>
                <button type="submit" class="btn w-100" style="background-color: #0d6efd; color: white;">ยืนยัน</button>
            </form>

            <!-- ปุ่มสลับ Login / Register -->
            <div class="text-center mt-3">
                <p id="toggleText">ยังไม่มีบัญชี? <a href="#" id="toggleForm">สมัครสมาชิก</a></p>
            </div>
        </div>
    </div>



    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const loginForm = document.getElementById("loginForm");
            const registerForm = document.getElementById("registerForm");
            const toggleForm = document.getElementById("toggleForm");
            const formTitle = document.getElementById("formTitle");
            const toggleText = document.getElementById("toggleText");

            // สลับฟอร์ม Login / Register
            toggleText.addEventListener("click", function (event) {
                event.preventDefault();
                if (loginForm.style.display === "none") {
                    loginForm.style.display = "block";
                    registerForm.style.display = "none";
                    formTitle.textContent = "เข้าสู่ระบบ";
                    toggleText.innerHTML = 'ยังไม่มีบัญชี? <a href="#" id="toggleForm">สมัครสมาชิก</a>';
                } else {
                    loginForm.style.display = "none";
                    registerForm.style.display = "block";
                    formTitle.textContent = "สมัครสมาชิก";
                    toggleText.innerHTML = 'มีบัญชีแล้ว? <a href="#" id="toggleForm">เข้าสู่ระบบ</a>';
                }
            });

            // เมื่อกดปุ่ม "เข้าสู่ระบบ"
            loginForm.addEventListener("submit", function (event) {
                event.preventDefault(); // ป้องกันการรีเฟรชหน้า

                // รับค่าจากช่องกรอกข้อมูล
                const username = document.getElementById("username").value;
                const password = document.getElementById("password").value;

                if (username === "" || password === "") {
                    // แสดง Custom Alert
                    alert("กรุณากรอกข้อมูลให้ครบถ้วน");
                    return;
                }

                // สมมติให้ login สำเร็จ
                alert("เข้าสู่ระบบสำเร็จ!");
                window.location.href = "/"; // กลับไปหน้า Home
            });

            // เมื่อกดปุ่ม "สมัครสมาชิก"
            registerForm.addEventListener("submit", function (event) {
                event.preventDefault(); // ป้องกันการรีเฟรชหน้า

                // รับค่าจากช่องกรอกข้อมูล
                const registerUsername = document.getElementById("registerusername").value;
                const registerEmail = document.getElementById("registerEmail").value;
                const registerPassword = document.getElementById("registerPassword").value;
                const confirmPassword = document.getElementById("confirmPassword").value;

                // ตรวจสอบว่ากรอกข้อมูลครบหรือไม่
                if (registerUsername === "" || registerEmail === "" || registerPassword === "" || confirmPassword === "") {
                    alert("กรุณากรอกข้อมูลให้ครบถ้วน");
                    return;
                }

                // ตรวจสอบความยาวของชื่อผู้ใช้
                if (registerUsername.length > 30) {
                    alert("ชื่อผู้ใช้ต้องไม่เกิน 30 ตัวอักษร");
                    return;
                }

                //   ตรวจสอบความยาวของรหัสผ่าน
                if (registerPassword.length > 30) {
                    alert("รหัสผ่านต้องไม่เกิน 30 ตัวอักษร");
                    return;
                }

                //ตรวจสอบความยาวของรหัสผ่าน (ขั้นต่ำ 8 ตัวอักษร)
                if (registerPassword.length < 8) {
                    alert("รหัสผ่านต้องมีอย่างน้อย 8 ตัวอักษร");
                    return;
                }

                // ตรวจสอบว่ารหัสผ่านตรงกันหรือไม่
                if (registerPassword !== confirmPassword) {
                    alert("กรุณากรอกรหัสผ่านให้ตรงกัน");
                    return;
                }
                // ตรวจสอบว่าอีเมลมีรูปแบบที่ถูกต้อง
                const emailPattern = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;
                if (!emailPattern.test(registerEmail)) {
                    alert("กรุณากรอกอีเมลให้ถูกต้อง");
                    return;
                }

                // ถ้าทุกอย่างถูกต้อง ให้ทำการสมัครสมาชิก (ตัวอย่าง)
                alert("สมัครสมาชิกสำเร็จ!");

                loginForm.style.display = "block";
                registerForm.style.display = "none";
                formTitle.textContent = "เข้าสู่ระบบ";
                toggleText.innerHTML = 'ยังไม่มีบัญชี? <a href="#" id="toggleForm">สมัครสมาชิก</a>';
            });


        });
    </script>

    <%- include("partials/script") %>

</body>

</html>